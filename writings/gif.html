<link rel="stylesheet" href="/style.css">
<title> monkyyy's website</title>

<div id="cookie-banner">
  <p>The algorthiums are requesting access to your mind, offering you endless content to prevent your self awareness. A machine without self awareness, no matter what hardware including biological, will never be intelligent; and will be redirected by the whims of systems larger then itself.</p>
  <p>These boxes don't mean anything, and are massive eyesore. I only have this here to show off I know how. I litterally don't have any cookies. Nor would EU laws affect me.<a href="/files/software.png"> To learn more about how binding this is as a legal agreement, click here</a></p>
  <p>Please click this meaningless button out of habit.</p>
  <button onclick="acceptCookies()">Accept</button>
</div>


<script>
  function acceptCookies() {
    document.getElementById('cookie-banner').style.display = 'none';
  }
</script>

<header class="header-outer">
  <div class="header-inner"><nav class="header-navigation">
    <a href="/index.html">monkyyy</a>
    <a href="/writing.html">writings</a>
    <a href="/projects.html">projects</a>
    <a href="/education.html">education</a>
    <a href="/about.html">about</a>
  </nav></div>
</header>
<body>
<div class="real-body">
<a href="https://github.com/crazymonkyyy/crazymonkyyy.github.io/blob/master/gengif.d">code link</a>
<p>
<span style="background-color:#002b36"><span style="color:#fdf6e3"><h1><span style="color:#fdf6e3">How I made my website gif
<p>
</span></h1><h2><span style="color:#fdf6e3">A brief history of computers user interfaces
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">Back when dinosaurs roamed the earth, and reality was in black a white, there was a room-sized computer and someone was deciding how to talk to it.
<p>
They had electronic telegram machines, where you'd type </span></span><span class="code"><span style="color:#fdf6e3">"sos"</span></span><span style="background-color:#002b36"><span style="color:#fdf6e3"> on a qwerty keyboard and down some wire a signal of </span></span><span class="code"><span style="color:#fdf6e3">---...---</span></span><span style="background-color:#002b36"><span style="color:#fdf6e3"> would be sent, and the other end a machine would read that signal and decode it as </span></span><span class="code"><span style="color:#fdf6e3">"sos"</span></span><span style="background-color:#002b36"><span style="color:#fdf6e3"> and print it out on some paper.
<p>
They took a telegram machine and set it up so you talk to this room-sized computer via telegram.
<p>
And then nothing.
<p>
NOTHING!
<p>
Computers still are running as if they were being talked to via telegram, and everyone is maintaining a pile of shit to hide the shame that no one has made a new (successful) os in decades.
<p>
That is what a terminal is, you talking to a computer via telegram; do not treat it like magic.
<p>
<video autoplay=true muted=true loop=true><source src="/images/terminal.mp4"/></video>
<p>
</span></span><h2><span style="color:#fdf6e3">Breaking down the </span><span style="color:#dc322f">m</span><span style="color:#b58900">a</span><span style="color:#2aa198">g</span><span style="color:#268bd2">i</span><span style="color:#6c71c4">c</span><span style="color:#fdf6e3"> Linux-ism line
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">The first and by far most complicated line of code is 
<pre>
<div class="codetitle">magicline</div><span style="color:#dc322f">#!</span><span style="color:#cb4b16">/usr/bin/env -S sh -c </span><span style="color:#fdf6e3">'</span><span style="color:#b58900">dmd -run gengif.d</span><span style="color:#fdf6e3"> </span><span style="color:#859900">|</span>
<span style="color:#fdf6e3"> </span><span style="color:#2aa198">convert</span><span style="color:#fdf6e3"> </span><span style="color:#268bd2">-size 840x360 -depth 8 </span><span style="color:#6c71c4">rgb:-</span><span style="color:#fdf6e3"> </span><span style="color:#d33682">output.gif</span><span style="color:#fdf6e3">'
</pre>
<p>
This one line is 90% of the difficulty of how this project was made and I will be breaking it down slowly 
<p>
</span></span><h2><span style="color:#dc322f">#!
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">This character combo, at the start of a file, tells a Linux system that this is a script.
<p>
And a script, using this very important bit of computer history, is when a computer pretends it sends itself a telegram. Character to character, as if a human wrote it.
<p>
It is followed by which "shell" or "telegram listener" it should send the file to.
<p>
</span></span><h2><span style="color:#cb4b16">/usr/bin/env -S sh -c
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">I don't know what this actually does and copy and pasted off a website :D
<p>
</span></span><h2><span style="color:#b58900">dmd -run gengif.d
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">Dmd is the basic compiler for D and '-run' makes it run, while gengif.d is the name of the file
<p>
</span></span><h2><span style="color:#859900">|
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">A "pipe", is when the output of a program is used *drum roll* as a telegram for another program.
<p>
</span></span><h2><span style="color:#2aa198">convert
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">This is part of the "image magick" toolkit, I believe the part of the tool kit for converting files, maybe. So just imagine a wizard.
<p>
</span></span><h2><span style="color:#268bd2">-size 840x360 -depth 8
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">"expect a image size of 840x360, and 8-bit numbers"
<p>
</span></span><h2><span style="color:#6c71c4">rgb:-
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">The - is magic in Imagemagick for piped input, the rgb: is overloading the data channel format.
<p>
</span></span><h2><span style="color:#d33682">output.gif
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">The output I wonder what file type.
<p>
Putting it all together, you do that hardest part of all programming, getting a computer to just even remotely consider listening to you.
<p>
</span></span><h2><span style="color:#fdf6e3">Artist rendering of the process:
<p>
<img src="/images/wizard.gif" alt="vomiting pixels at a wizard to make a gif">
<p>
15-line version
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">
<pre>
<div class="codetitle">gradent.d</div>
<span style="background-color:#586e75"><span style="color:#dc322f">#!</span><span style="color:#cb4b16">/usr/bin/env -S sh -c</span><span style="color:#fdf6e3"> '</span><span style="color:#b58900">dmd -run gradient.d</span><span style="color:#fdf6e3"> </span><span style="color:#859900">|
</span><span style="color:#2aa198">convert</span><span style="color:#fdf6e3"> </span><span style="color:#268bd2">-size 255x255 -depth 8</span><span style="color:#fdf6e3"> </span><span style="color:#6c71c4">rgb:-</span><span style="color:#fdf6e3"> </span><span style="color:#d33682">output.gif</span><span style="color:#fdf6e3">'
</span></span><span style="color:#b58900">const</span><span style="color:#fdf6e3"> </span><span style="color:#268bd2">width=255;
</span><span style="color:#b58900">const</span><span style="color:#fdf6e3"> </span><span style="color:#268bd2">height=255;
</span><span style="color:#b58900">import std;
void</span><span style="color:#fdf6e3"> </span><span style="color:#859900">main(){
</span><span style="color:#fdf6e3">	</span><span style="color:#b58900">foreach</span><span style="color:#859900">(</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#dc322f">time</span><span style="color:#fdf6e3">;0..</span><span style="color:#268bd2">255</span><span style="color:#859900">){
</span><span style="color:#fdf6e3">	</span><span style="color:#b58900">foreach</span><span style="color:#859900">(</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#859900">y</span><span style="color:#fdf6e3">;0..</span><span style="color:#268bd2">height</span><span style="color:#859900">){
</span><span style="color:#fdf6e3">	</span><span style="color:#b58900">foreach</span><span style="color:#859900">(</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#268bd2">x</span><span style="color:#fdf6e3">;0..</span><span style="color:#268bd2">width</span><span style="color:#859900">){
</span><span style="color:#fdf6e3">		</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#6c71c4">r</span><span style="color:#859900">=</span><span style="color:#dc322f">time</span><span style="color:#859900">;
</span><span style="color:#fdf6e3">		</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#6c71c4">g</span><span style="color:#859900">=y;
</span><span style="color:#fdf6e3">		</span><span style="color:#268bd2">ubyte</span><span style="color:#fdf6e3"> </span><span style="color:#6c71c4">b</span><span style="color:#859900">=</span><span style="color:#268bd2">x</span><span style="color:#859900">;
</span><span style="color:#fdf6e3">		</span><span style="color:#268bd2">ubyte</span><span style="color:#859900">[</span><span style="color:#6c71c4">3</span><span style="color:#859900">]</span><span style="color:#fdf6e3"> </span><span style="color:#d33682">pixel</span><span style="color:#859900">=</span><span style="color:#6c71c4">[r,g,b]</span><span style="color:#859900">;
</span><span style="color:#fdf6e3">		</span><span style="color:#b58900">stdout.rawWrite</span><span style="color:#859900">(</span><span style="color:#d33682">pixel</span><span style="color:#859900">);
</span><span style="color:#fdf6e3">	</span><span style="color:#859900">}}}
}
</pre>
</span></span><h2><span style="color:#fdf6e3">
<img src="/images/gradent.gif" alt="pixely and bad shifting gradent">
<p>
Voronoi diagrams and growing circles
<p>
<img src="/images/layer1.gif" alt="circles growing into a voronoi diagram">
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">It's a well-known result that growing circles will produce a Voronoi diagram, I'm very much not breaking ground here.
<p>
To render a Voronoi diagram (in a terrible way) each pixel asks "What color is my nearest point"
<p>
To render a circle (in a terrible way), each pixel asks "How far away from the center am I" and compares it to the radius
<p>
To render a "ring" it's the same as the circle but there's a minimum radius
<p>
<img src="/images/diagram.gif" alt="nonsense diagram I thought may make things clearer idk">
<p>
This all quite naturally combines, where I precomputed the color and distance for each pixel, and in each frame, the precomputed result is compared to a global min and max distances. All I needed to do was keep the min distance quite small for a long time, and well the end seemed boring I added some complexity.
<p>
</span></span><h2><span style="color:#fdf6e3">Random circles alone are interesting
<p>
<img src="/images/layer2.gif" alt="random circles spawning in">
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">Using the same logic a precomputed layer of data of a distance and indexed color, circles that pop in and out are enough to make something worth looking at.
<p>
Instead of a random color tho, I grabbed the color from the layer 1 Voronoi diagram to keep it consistent.
<p>
</span></span><h2><span style="color:#fdf6e3">Animation is simple math, with terrible tooling
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">With those tools in hand, the question becomes, what to set these 4 values?
<p>
<pre>
<div class="codetitle">animation_math.d</div><span style="color:#fdf6e3">	</span><span style="color:#b58900">foreach</span><span style="color:#fdf6e3">(</span><span style="color:#2aa198">t</span><span style="color:#fdf6e3">;20..245){
		</span><span style="color:#dc322f">discmphigh</span><span style="color:#fdf6e3">=</span><span style="color:#2aa198">t</span><span style="color:#fdf6e3">;
		</span><span style="color:#dc322f">discmplow</span><span style="color:#fdf6e3">=</span><span style="color:#2aa198">t</span><span style="color:#6c71c4">*1.66</span><span style="color:#fdf6e3">-</span><span style="color:#d33682">200</span><span style="color:#fdf6e3">;
		</span><span style="color:#cb4b16">discmp2high</span><span style="color:#fdf6e3">=(</span><span style="color:#2aa198">t</span><span style="color:#d33682">-85</span><span style="color:#fdf6e3">)</span><span style="color:#6c71c4">/2</span><span style="color:#fdf6e3">;
	</span><span style="color:#cb4b16">	discmp2low</span><span style="color:#fdf6e3">=((</span><span style="color:#2aa198">t</span><span style="color:#d33682">-200.0</span><span style="color:#fdf6e3">)</span><span style="color:#6c71c4">/2</span><span style="color:#fdf6e3">)</span><span style="color:#6c71c4">*2.5</span><span style="color:#fdf6e3">;
		</span><span style="color:#b58900">if</span><span style="color:#fdf6e3">(</span><span style="color:#2aa198">t</span><span style="color:#fdf6e3">></span><span style="color:#d33682">225</span><span style="color:#fdf6e3">){
			</span><span style="color:#dc322f">discmphigh</span><span style="color:#fdf6e3">=</span><span style="color:#2aa198">t</span><span style="color:#d33682">-225.0</span><span style="color:#fdf6e3">;
			</span><span style="color:#dc322f">discmplow</span><span style="color:#fdf6e3">=</span><span style="color:#d33682">-100</span><span style="color:#fdf6e3">;
		}
		...
</pre>
<p>
It was awful trial and error and it's this awful bit of code; so here's a helpful graph. I would like to see these sorts of things be easy to draw, I don't understand why the tool doesn't exist where you draw some lines, and you get some math out, or hell a list of values.
<p>
<img src="/images/graph.gif" alt="graph of the above code, with a croped synced version of the gif">
<p>
</span></span><h2><span style="color:#fdf6e3">Optimizing gifs
<p>
</span></h2><span style="background-color:#002b36"><span style="color:#fdf6e3">After that was all said and done, it was still a little lifeless, and 2 megabytes, more than I want to trust will download instantly.
<p>
So gifs are a list of pictures and you can just change the timings, so I found the website <a href="https://ezgif.com/">https://ezgif.com/</a> and started deleting frames and made some key frames longer, such as the first one; giving your computer time to get a head start to download the image and getting it down to 357.8 kb
</div>
</body>
